@echo off
chcp 65001 > nul

:: –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Æ—Ä–ü–æ–º–æ—â–Ω–∏–∫ –≤ Windows

echo üöÄ –ó–∞–ø—É—Å–∫ –Æ—Ä–ü–æ–º–æ—â–Ω–∏–∫–∞...

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ .env —Ñ–∞–π–ª–∞
if not exist ".env" (
    echo ‚ùå –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo üìù –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –Ω–∞ –æ—Å–Ω–æ–≤–µ env.example
    echo    copy env.example .env
    echo    notepad .env
    pause
    exit /b 1
)

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Python
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω! –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.8+
    pause
    exit /b 1
)

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if not exist "venv" (
    echo üì¶ –°–æ–∑–¥–∞—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ...
    python -m venv venv
)

:: –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
echo üîß –ê–∫—Ç–∏–≤–∏—Ä—É—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ...
call venv\Scripts\activate.bat

:: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
echo üìö –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏...
pip install -r requirements.txt

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–∞–ø–∫–∏ data
if not exist "data" (
    echo üìÅ –°–æ–∑–¥–∞—é –ø–∞–ø–∫—É data...
    mkdir data
)

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ PDF —Ñ–∞–π–ª–æ–≤
dir data\*.pdf >nul 2>&1
if %errorlevel% neq 0 (
    echo üìÑ –î–æ–±–∞–≤—å—Ç–µ PDF —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É data\ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞
    echo    python scripts\populate_db.py
    echo.
)

:: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
if not exist "db\chroma" (
    echo üß† –°–æ–∑–¥–∞—é –±–∞–∑—É –∑–Ω–∞–Ω–∏–π...
    python scripts\populate_db.py
)

:: –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
echo ü§ñ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞...
python main.py

pause 